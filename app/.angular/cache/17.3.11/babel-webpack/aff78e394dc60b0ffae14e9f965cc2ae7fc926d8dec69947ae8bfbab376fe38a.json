{"ast":null,"code":"import _asyncToGenerator from \"/home/exshy/Documents/GitHub/Briefs/Angular/MusicStream/cursor_app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { from } from 'rxjs';\nimport { db } from './db.service';\nimport * as i0 from \"@angular/core\";\nexport class TrackService {\n  loadTracks() {\n    return from(db.tracks.toArray());\n  }\n  addTrack(trackData, audioFile) {\n    return from(this.addTrackToDb(trackData, audioFile));\n  }\n  addTrackToDb(trackData, audioFile) {\n    return _asyncToGenerator(function* () {\n      const audioBlob = new Blob([audioFile], {\n        type: audioFile.type\n      });\n      const track = {\n        ...trackData,\n        addedDate: new Date(),\n        duration: 0,\n        audioUrl: URL.createObjectURL(audioBlob)\n      };\n      const trackId = yield db.tracks.add(track);\n      yield db.audioFiles.add({\n        trackId,\n        blob: audioBlob\n      });\n      return {\n        ...track,\n        id: trackId\n      };\n    })();\n  }\n  deleteTrack(trackId) {\n    return from(this.deleteTrackFromDb(trackId));\n  }\n  deleteTrackFromDb(trackId) {\n    return _asyncToGenerator(function* () {\n      yield db.tracks.delete(trackId);\n      yield db.audioFiles.where('trackId').equals(trackId).delete();\n    })();\n  }\n  static {\n    this.ɵfac = function TrackService_Factory(t) {\n      return new (t || TrackService)();\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: TrackService,\n      factory: TrackService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["from","db","TrackService","loadTracks","tracks","toArray","addTrack","trackData","audioFile","addTrackToDb","_asyncToGenerator","audioBlob","Blob","type","track","addedDate","Date","duration","audioUrl","URL","createObjectURL","trackId","add","audioFiles","blob","id","deleteTrack","deleteTrackFromDb","delete","where","equals","factory","ɵfac","providedIn"],"sources":["/home/exshy/Documents/GitHub/Briefs/Angular/MusicStream/cursor_app/src/app/core/services/track.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { from, Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { db } from './db.service';\nimport { Track } from '../models/track.model';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class TrackService {\n  loadTracks(): Observable<Track[]> {\n    return from(db.tracks.toArray());\n  }\n\n  addTrack(trackData: Partial<Track>, audioFile: File): Observable<Track> {\n    return from(this.addTrackToDb(trackData, audioFile));\n  }\n\n  private async addTrackToDb(trackData: Partial<Track>, audioFile: File): Promise<Track> {\n    const audioBlob = new Blob([audioFile], { type: audioFile.type });\n    \n    const track: Track = {\n      ...trackData,\n      addedDate: new Date(),\n      duration: 0,\n      audioUrl: URL.createObjectURL(audioBlob)\n    } as Track;\n\n    const trackId = await db.tracks.add(track);\n    await db.audioFiles.add({\n      trackId,\n      blob: audioBlob\n    });\n\n    return { ...track, id: trackId };\n  }\n\n  deleteTrack(trackId: number): Observable<void> {\n    return from(this.deleteTrackFromDb(trackId));\n  }\n\n  private async deleteTrackFromDb(trackId: number): Promise<void> {\n    await db.tracks.delete(trackId);\n    await db.audioFiles.where('trackId').equals(trackId).delete();\n  }\n} "],"mappings":";AACA,SAASA,IAAI,QAAoB,MAAM;AAEvC,SAASC,EAAE,QAAQ,cAAc;;AAMjC,OAAM,MAAOC,YAAY;EACvBC,UAAUA,CAAA;IACR,OAAOH,IAAI,CAACC,EAAE,CAACG,MAAM,CAACC,OAAO,EAAE,CAAC;EAClC;EAEAC,QAAQA,CAACC,SAAyB,EAAEC,SAAe;IACjD,OAAOR,IAAI,CAAC,IAAI,CAACS,YAAY,CAACF,SAAS,EAAEC,SAAS,CAAC,CAAC;EACtD;EAEcC,YAAYA,CAACF,SAAyB,EAAEC,SAAe;IAAA,OAAAE,iBAAA;MACnE,MAAMC,SAAS,GAAG,IAAIC,IAAI,CAAC,CAACJ,SAAS,CAAC,EAAE;QAAEK,IAAI,EAAEL,SAAS,CAACK;MAAI,CAAE,CAAC;MAEjE,MAAMC,KAAK,GAAU;QACnB,GAAGP,SAAS;QACZQ,SAAS,EAAE,IAAIC,IAAI,EAAE;QACrBC,QAAQ,EAAE,CAAC;QACXC,QAAQ,EAAEC,GAAG,CAACC,eAAe,CAACT,SAAS;OAC/B;MAEV,MAAMU,OAAO,SAASpB,EAAE,CAACG,MAAM,CAACkB,GAAG,CAACR,KAAK,CAAC;MAC1C,MAAMb,EAAE,CAACsB,UAAU,CAACD,GAAG,CAAC;QACtBD,OAAO;QACPG,IAAI,EAAEb;OACP,CAAC;MAEF,OAAO;QAAE,GAAGG,KAAK;QAAEW,EAAE,EAAEJ;MAAO,CAAE;IAAC;EACnC;EAEAK,WAAWA,CAACL,OAAe;IACzB,OAAOrB,IAAI,CAAC,IAAI,CAAC2B,iBAAiB,CAACN,OAAO,CAAC,CAAC;EAC9C;EAEcM,iBAAiBA,CAACN,OAAe;IAAA,OAAAX,iBAAA;MAC7C,MAAMT,EAAE,CAACG,MAAM,CAACwB,MAAM,CAACP,OAAO,CAAC;MAC/B,MAAMpB,EAAE,CAACsB,UAAU,CAACM,KAAK,CAAC,SAAS,CAAC,CAACC,MAAM,CAACT,OAAO,CAAC,CAACO,MAAM,EAAE;IAAC;EAChE;;;uBAnCW1B,YAAY;IAAA;EAAA;;;aAAZA,YAAY;MAAA6B,OAAA,EAAZ7B,YAAY,CAAA8B,IAAA;MAAAC,UAAA,EAFX;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}